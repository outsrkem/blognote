{% extends 'base.html' %}
{% block base %}
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <div class="col-sm-2 col-12 admin-side" style="padding-top: 10px;margin:20px">
        <ul class="" style=";text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='#'>我的收藏</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='/prepost'>发布文章</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='#'>我的草稿</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none;display:inline;"><a href='#'>我的文章</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='#'>我的评论</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='#'>我的积分</a></li>
        </ul>
        <ul class="" style="text-align:center; padding-left: 0px">
            <li style="list-style-type:none; display:inline;"><a href='#'>个人资料</a></li>
        </ul>
    </div>
    <div class="col-sm-9 col-12 admin-side" style="padding-top: 10px;margin:20px">
        <div class="container">
            <div class="row">
                <div class="col">
                    <ul id="cont">
                        <li v-for="(article) in content">
                            <div class="col-11">
                                <hr style="height:1px;border:none;border-top:1px solid #474ad3;"/>
                                <a :href="'/article/' + article[0]">${article[0]} ${article[1]}</a>
                                <button type="button" class="btn btn-primary" style="float:right;">编辑</button>
                                <button type="button" onclick="delArticle(${article[0]}" class="btn btn-danger" style="float:right;">
                                    删除
                                </button>
                            </div>
                        </li>
                    </ul>

                </div>

            </div>

        </div>

        <script type="text/javascript">
            //获取文章
            $(document).ready(function () {
                // 1、请求接口，获取json
                $.get('/admin/myarticle', function (data) {
                    var lastData = data;
                    // 2、获取响应填充到推荐栏中
                    var v1 = new Vue({
                        el: '#cont', //绑定的元素不可与v-for同级
                        data: {content: lastData},
                        delimiters: ['${', '}']  //自定义分隔符
                    });
                })
            });

            //删除文章
            function delArticle(obj, articleid) {
                param = "&articleid=" + articleid;
                $.post('/opinion', param, function (data) {
                    if (data == 'del-pass') {
                        bootbox.alert({title: "提示", message: "删除成功."});
                    }
                    else if (data == 'del-error'){
                        bootbox.alert({title: "提示", message: "系统错误."});
                    }
                })
            }
        </script>
{% endblock base %}